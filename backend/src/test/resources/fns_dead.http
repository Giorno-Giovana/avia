### TOKEN
POST http://185.209.114.26:9001/auth/realms/plutdev/protocol/openid-connect/token
Content-Type: application/x-www-form-urlencoded

username=agent2&password=agent2&grant_type=password&tocken_type=bearer&client_secret=e5d2b5c1-4211-48aa-b272-91d75f4ab0e5&client_id=agentService

### Создание персоны
POST http://185.209.114.26:8080/subject/person/individual
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJma1RiRXhkbUw0Z01ibkxPUWtJQmg0NzA0elA1bWo2TVF2U0V5a3hNb3o0In0.eyJqdGkiOiJkNGRmNzViNC0xOGQxLTQ4ZTctYWMyNC1kM2M3ODhkMzNhYjgiLCJleHAiOjE2MTkxMjc5OTcsIm5iZiI6MCwiaWF0IjoxNjE5MTI3Njk3LCJpc3MiOiJodHRwOi8vMTg1LjIwOS4xMTQuMjY6OTAwMS9hdXRoL3JlYWxtcy9wbHV0ZGV2IiwiYXVkIjpbImludm9pY2VTZXJ2aWNlIiwiYWNjb3VudFNlcnZpY2UiLCJwaXBlbGluZVNlcnZpY2UiLCJwZXJzb25TZXJ2aWNlIiwic216U2VydmljZSIsInBheXRvb2xzU2VydmljZSIsImt5Y1NlcnZpY2UiLCJpbnRlcm5hbEFwaVNlcnZpY2UiLCJhY2NvdW50IiwiY29uY2x1c2lvblNlcnZpY2UiXSwic3ViIjoiY2E5OGQ2ZjctNGM3Zi00YWIzLWJkNjItOTBiMDNmMGRiMTBjIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYWdlbnRTZXJ2aWNlIiwiYXV0aF90aW1lIjowLCJzZXNzaW9uX3N0YXRlIjoiYWU3ZmUzNWYtYzI0ZS00ZGQwLTljOTktMTIxNmE2NDhjYTk0IiwiYWNyIjoiMSIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiaW52b2ljZVNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwiYWNjb3VudFNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwicGlwZWxpbmVTZXJ2aWNlIjp7InJvbGVzIjpbIlVTRVIiXX0sInBlcnNvblNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwic216U2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19LCJwYXl0b29sc1NlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwia3ljU2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19LCJpbnRlcm5hbEFwaVNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19LCJjb25jbHVzaW9uU2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiTGVnYWxFbnRpdHlTZXR0aW5ncyI6eyJpZCI6IjE4NmI3YjQxLWUzZTAtNDc1Yy1iM2UyLWFlNjZhYWYwYWVmNSJ9LCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImFnZW50MiJ9.echW2dpZqYpMI1HSThVSHnahdGmZS2ltuuIpr5WhRERC9NAdG93syhoKpc4VLQuYVsN-EDMGsk7Azud0NR5epLOSspyCAkeVmhyqyezb1BMi4uYKi-Z1Eo--qPfuqSTCXPJ7eH45vr8pGt_93GGDgpXBQyvk5B7p9DpuM1ZIiIljhrv1iIzkSLIRAigh3TaWWAyau_Dt2NOZ0IfxI5pnzCuJzeFMue7KiRNJohoTmxVdiHooViCjoQC5FzRYyoqfEGdDVW_DKQkDgLteCL0ktX8mtJqXANT2vXJwZWgRu0f4E-KZicREI_M8o5KwmwVT3DJi9TLHIU1iEKr8IU8_Yw

{
  "externalId": "c1f37217-02b6-4a6e-938f-acd06025d2fc",
  "nationality": "RUS",
  "initials": {
    "firstName": "Артемий",
    "lastName": "Талалуев",
    "patronymic": "Андреевич"
  },
  "inn": {
    "inn": "503228909843"
  },
  "phone": {
    "phone": "79166096078"
  }
}
###

### Привязка карты физического лица (ExternalId = идентификатор персоны)
# 4692065455989192 - успешная выплата
# 4485913187374384 - неуспешная выплата

POST http://185.209.114.26:8080/invoicing/paytools/card
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJma1RiRXhkbUw0Z01ibkxPUWtJQmg0NzA0elA1bWo2TVF2U0V5a3hNb3o0In0.eyJqdGkiOiJkNGRmNzViNC0xOGQxLTQ4ZTctYWMyNC1kM2M3ODhkMzNhYjgiLCJleHAiOjE2MTkxMjc5OTcsIm5iZiI6MCwiaWF0IjoxNjE5MTI3Njk3LCJpc3MiOiJodHRwOi8vMTg1LjIwOS4xMTQuMjY6OTAwMS9hdXRoL3JlYWxtcy9wbHV0ZGV2IiwiYXVkIjpbImludm9pY2VTZXJ2aWNlIiwiYWNjb3VudFNlcnZpY2UiLCJwaXBlbGluZVNlcnZpY2UiLCJwZXJzb25TZXJ2aWNlIiwic216U2VydmljZSIsInBheXRvb2xzU2VydmljZSIsImt5Y1NlcnZpY2UiLCJpbnRlcm5hbEFwaVNlcnZpY2UiLCJhY2NvdW50IiwiY29uY2x1c2lvblNlcnZpY2UiXSwic3ViIjoiY2E5OGQ2ZjctNGM3Zi00YWIzLWJkNjItOTBiMDNmMGRiMTBjIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYWdlbnRTZXJ2aWNlIiwiYXV0aF90aW1lIjowLCJzZXNzaW9uX3N0YXRlIjoiYWU3ZmUzNWYtYzI0ZS00ZGQwLTljOTktMTIxNmE2NDhjYTk0IiwiYWNyIjoiMSIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiaW52b2ljZVNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwiYWNjb3VudFNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwicGlwZWxpbmVTZXJ2aWNlIjp7InJvbGVzIjpbIlVTRVIiXX0sInBlcnNvblNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwic216U2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19LCJwYXl0b29sc1NlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwia3ljU2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19LCJpbnRlcm5hbEFwaVNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19LCJjb25jbHVzaW9uU2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiTGVnYWxFbnRpdHlTZXR0aW5ncyI6eyJpZCI6IjE4NmI3YjQxLWUzZTAtNDc1Yy1iM2UyLWFlNjZhYWYwYWVmNSJ9LCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImFnZW50MiJ9.echW2dpZqYpMI1HSThVSHnahdGmZS2ltuuIpr5WhRERC9NAdG93syhoKpc4VLQuYVsN-EDMGsk7Azud0NR5epLOSspyCAkeVmhyqyezb1BMi4uYKi-Z1Eo--qPfuqSTCXPJ7eH45vr8pGt_93GGDgpXBQyvk5B7p9DpuM1ZIiIljhrv1iIzkSLIRAigh3TaWWAyau_Dt2NOZ0IfxI5pnzCuJzeFMue7KiRNJohoTmxVdiHooViCjoQC5FzRYyoqfEGdDVW_DKQkDgLteCL0ktX8mtJqXANT2vXJwZWgRu0f4E-KZicREI_M8o5KwmwVT3DJi9TLHIU1iEKr8IU8_Yw
Content-Type: application/json

{
  "externalId": "c1f37217-02b6-4a6e-938f-acd06025d2fc",
  "number": "4929509947106878"
}

###

### Привязка самозанятого к платформе
PUT http://185.209.114.26:8080/subject/smz/4804832c-8e89-4d2a-80a5-452e8bdf807d/bind
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJma1RiRXhkbUw0Z01ibkxPUWtJQmg0NzA0elA1bWo2TVF2U0V5a3hNb3o0In0.eyJqdGkiOiJkNGRmNzViNC0xOGQxLTQ4ZTctYWMyNC1kM2M3ODhkMzNhYjgiLCJleHAiOjE2MTkxMjc5OTcsIm5iZiI6MCwiaWF0IjoxNjE5MTI3Njk3LCJpc3MiOiJodHRwOi8vMTg1LjIwOS4xMTQuMjY6OTAwMS9hdXRoL3JlYWxtcy9wbHV0ZGV2IiwiYXVkIjpbImludm9pY2VTZXJ2aWNlIiwiYWNjb3VudFNlcnZpY2UiLCJwaXBlbGluZVNlcnZpY2UiLCJwZXJzb25TZXJ2aWNlIiwic216U2VydmljZSIsInBheXRvb2xzU2VydmljZSIsImt5Y1NlcnZpY2UiLCJpbnRlcm5hbEFwaVNlcnZpY2UiLCJhY2NvdW50IiwiY29uY2x1c2lvblNlcnZpY2UiXSwic3ViIjoiY2E5OGQ2ZjctNGM3Zi00YWIzLWJkNjItOTBiMDNmMGRiMTBjIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYWdlbnRTZXJ2aWNlIiwiYXV0aF90aW1lIjowLCJzZXNzaW9uX3N0YXRlIjoiYWU3ZmUzNWYtYzI0ZS00ZGQwLTljOTktMTIxNmE2NDhjYTk0IiwiYWNyIjoiMSIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiaW52b2ljZVNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwiYWNjb3VudFNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwicGlwZWxpbmVTZXJ2aWNlIjp7InJvbGVzIjpbIlVTRVIiXX0sInBlcnNvblNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwic216U2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19LCJwYXl0b29sc1NlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwia3ljU2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19LCJpbnRlcm5hbEFwaVNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19LCJjb25jbHVzaW9uU2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiTGVnYWxFbnRpdHlTZXR0aW5ncyI6eyJpZCI6IjE4NmI3YjQxLWUzZTAtNDc1Yy1iM2UyLWFlNjZhYWYwYWVmNSJ9LCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImFnZW50MiJ9.echW2dpZqYpMI1HSThVSHnahdGmZS2ltuuIpr5WhRERC9NAdG93syhoKpc4VLQuYVsN-EDMGsk7Azud0NR5epLOSspyCAkeVmhyqyezb1BMi4uYKi-Z1Eo--qPfuqSTCXPJ7eH45vr8pGt_93GGDgpXBQyvk5B7p9DpuM1ZIiIljhrv1iIzkSLIRAigh3TaWWAyau_Dt2NOZ0IfxI5pnzCuJzeFMue7KiRNJohoTmxVdiHooViCjoQC5FzRYyoqfEGdDVW_DKQkDgLteCL0ktX8mtJqXANT2vXJwZWgRu0f4E-KZicREI_M8o5KwmwVT3DJi9TLHIU1iEKr8IU8_Yw
Content-Type: application/json

{
  "permissions": ["INCOME_REGISTRATION","PAYMENT_INFORMATION","INCOME_LIST","INCOME_SUMMARY","CANCEL_INCOME"],
  "externalId": "c1f37217-02b6-4a6e-938f-acd06025d2fc"
}
###

### Проверка статуса привязки
GET http://185.209.114.26:8080/subject/smz/4804832c-8e89-4d2a-80a5-452e8bdf807d/status/80923378-b34b-4c23-aa38-677cd104f0f5
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJma1RiRXhkbUw0Z01ibkxPUWtJQmg0NzA0elA1bWo2TVF2U0V5a3hNb3o0In0.eyJqdGkiOiJkNGRmNzViNC0xOGQxLTQ4ZTctYWMyNC1kM2M3ODhkMzNhYjgiLCJleHAiOjE2MTkxMjc5OTcsIm5iZiI6MCwiaWF0IjoxNjE5MTI3Njk3LCJpc3MiOiJodHRwOi8vMTg1LjIwOS4xMTQuMjY6OTAwMS9hdXRoL3JlYWxtcy9wbHV0ZGV2IiwiYXVkIjpbImludm9pY2VTZXJ2aWNlIiwiYWNjb3VudFNlcnZpY2UiLCJwaXBlbGluZVNlcnZpY2UiLCJwZXJzb25TZXJ2aWNlIiwic216U2VydmljZSIsInBheXRvb2xzU2VydmljZSIsImt5Y1NlcnZpY2UiLCJpbnRlcm5hbEFwaVNlcnZpY2UiLCJhY2NvdW50IiwiY29uY2x1c2lvblNlcnZpY2UiXSwic3ViIjoiY2E5OGQ2ZjctNGM3Zi00YWIzLWJkNjItOTBiMDNmMGRiMTBjIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYWdlbnRTZXJ2aWNlIiwiYXV0aF90aW1lIjowLCJzZXNzaW9uX3N0YXRlIjoiYWU3ZmUzNWYtYzI0ZS00ZGQwLTljOTktMTIxNmE2NDhjYTk0IiwiYWNyIjoiMSIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiaW52b2ljZVNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwiYWNjb3VudFNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwicGlwZWxpbmVTZXJ2aWNlIjp7InJvbGVzIjpbIlVTRVIiXX0sInBlcnNvblNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwic216U2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19LCJwYXl0b29sc1NlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwia3ljU2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19LCJpbnRlcm5hbEFwaVNlcnZpY2UiOnsicm9sZXMiOlsiVVNFUiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19LCJjb25jbHVzaW9uU2VydmljZSI6eyJyb2xlcyI6WyJVU0VSIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwiTGVnYWxFbnRpdHlTZXR0aW5ncyI6eyJpZCI6IjE4NmI3YjQxLWUzZTAtNDc1Yy1iM2UyLWFlNjZhYWYwYWVmNSJ9LCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImFnZW50MiJ9.echW2dpZqYpMI1HSThVSHnahdGmZS2ltuuIpr5WhRERC9NAdG93syhoKpc4VLQuYVsN-EDMGsk7Azud0NR5epLOSspyCAkeVmhyqyezb1BMi4uYKi-Z1Eo--qPfuqSTCXPJ7eH45vr8pGt_93GGDgpXBQyvk5B7p9DpuM1ZIiIljhrv1iIzkSLIRAigh3TaWWAyau_Dt2NOZ0IfxI5pnzCuJzeFMue7KiRNJohoTmxVdiHooViCjoQC5FzRYyoqfEGdDVW_DKQkDgLteCL0ktX8mtJqXANT2vXJwZWgRu0f4E-KZicREI_M8o5KwmwVT3DJi9TLHIU1iEKr8IU8_Yw
Content-Type: application/json

{
  "externalId": "c1f37217-02b6-4a6e-938f-acd06025d2fc"
}
###

### Создание инвойса
#fromPerson - всегда идентификатор физического лица
#toPerson - всегда идентификатор юридического лица (вашей площадки)

POST http://185.209.114.26:8080/invoicing/invoice
Authorization: Bearer <token>
Content-Type: application/json

{
  "externalId": "9fc75a06-4ac3-4a90-953e-f9da9e8f6385",
  "fromPerson": {
    "id": "<personId>"
  },
  "toPerson": {
    "id": "51b2edc7-77fe-4751-95a0-7f6c48bd2e25"
  },
  "payload": {
    "transferNote": {
      "note": "test"
    },
    "finance": {
      "userAmount": 100
    },
    "providerIn": "TESTCARD",
    "providerOut": "TESTCARD"
  }
}
###

### Акцепт инвойса
PUT http://185.209.114.26:8080/invoicing/invoice/<invoiceId>/accept
Authorization: Bearer <token>

{
    "id": "<invoiceId>"
}

### Запрос состояния счета по его идентификатору
#Здесь особо нужно обратить внимание на $.payload.params[0].second. Это адрес страницы инвойса, на котором можно совершить поплнение.
GET http://185.209.114.26:8080/invoicing/invoice/<invoiceId>
Authorization: Bearer <token>
